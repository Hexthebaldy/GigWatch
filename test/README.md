# GigWatch æµ‹è¯•å¥—ä»¶

## æµ‹è¯•æ–‡ä»¶è¯´æ˜

### å•å…ƒæµ‹è¯•ï¼ˆUnit Testsï¼‰

**`tools.test.ts`** - å·¥å…·ç³»ç»Ÿæµ‹è¯•
- ToolRegistry åŠŸèƒ½
- Tool æ¥å£å®ç°
- æ•°æ®åº“å·¥å…·ï¼ˆupsert, load, logï¼‰
- å‚æ•°éªŒè¯
- Schema è½¬æ¢

è¿è¡Œï¼š
```bash
bun run test/tools.test.ts
```

**`agent.test.ts`** - Agent æ‰§è¡Œå™¨æµ‹è¯•
- AgentExecutor åŸºæœ¬åŠŸèƒ½
- ä»»åŠ¡ç±»å‹å¤„ç†
- é”™è¯¯å¤„ç†
- ç»“æœç»“æ„éªŒè¯

è¿è¡Œï¼š
```bash
bun run test/agent.test.ts
```

**`telegram.test.ts`** - Telegram é€šçŸ¥æµ‹è¯•
- Telegram Bot é›†æˆ
- æ¶ˆæ¯å‘é€
- ä¼˜å…ˆçº§æ§åˆ¶
- æ ¼å¼åŒ–æ”¯æŒ

è¿è¡Œï¼š
```bash
# éœ€è¦å…ˆé…ç½®ç¯å¢ƒå˜é‡
export TELEGRAM_BOT_TOKEN="ä½ çš„token"
export TELEGRAM_CHAT_ID="ä½ çš„chat_id"

bun run test/telegram.test.ts
```

---

## å¿«é€Ÿè¿è¡Œ

### è¿è¡Œæ‰€æœ‰å•å…ƒæµ‹è¯•ï¼ˆä¸å«ç½‘ç»œè¯·æ±‚ï¼‰

```bash
bun run test/tools.test.ts && bun run test/agent.test.ts
```

### è¿è¡ŒåŒ…å«ç½‘ç»œè¯·æ±‚çš„æµ‹è¯•

```bash
# Telegram æµ‹è¯•ï¼ˆéœ€è¦é…ç½®ï¼‰
bun run test/telegram.test.ts
```

---

## æµ‹è¯•ç»„ç»‡åŸåˆ™

### å•å…ƒæµ‹è¯•
- ä¸ä¾èµ–å¤–éƒ¨æœåŠ¡ï¼ˆä½¿ç”¨ mock/å†…å­˜æ•°æ®åº“ï¼‰
- å¿«é€Ÿæ‰§è¡Œï¼ˆ< 1ç§’ï¼‰
- ç‹¬ç«‹è¿è¡Œ
- æ–‡ä»¶å‘½åï¼š`*.test.ts`

### é›†æˆæµ‹è¯•ï¼ˆæœªæ¥ï¼‰
- æµ‹è¯•å®Œæ•´æµç¨‹
- å¯èƒ½åŒ…å«ç½‘ç»œè¯·æ±‚
- ä½¿ç”¨çœŸå®é…ç½®
- æ–‡ä»¶å‘½åï¼š`*.integration.test.ts`

### ç«¯åˆ°ç«¯æµ‹è¯•ï¼ˆæœªæ¥ï¼‰
- æµ‹è¯•ç”¨æˆ·åœºæ™¯
- å®Œæ•´çš„ç³»ç»Ÿæµ‹è¯•
- æ–‡ä»¶å‘½åï¼š`*.e2e.test.ts`

---

## ç¼–å†™æµ‹è¯•çš„æœ€ä½³å®è·µ

### 1. æ˜ç¡®æµ‹è¯•ç›®æ ‡
```typescript
console.log("Test 1: Tool registry basic operations");
// æ¸…æ™°è¯´æ˜è¿™ä¸ªæµ‹è¯•åœ¨æµ‹ä»€ä¹ˆ
```

### 2. ä½¿ç”¨å†…å­˜æ•°æ®åº“
```typescript
const db = new Database(":memory:");
// é¿å…å½±å“å®é™…æ•°æ®
```

### 3. ç‹¬ç«‹çš„æµ‹è¯•ç”¨ä¾‹
```typescript
// âœ… å¥½ï¼šæ¯ä¸ªæµ‹è¯•ç‹¬ç«‹
const test1 = await tool.execute({...});
const test2 = await tool.execute({...});

// âŒ é¿å…ï¼šæµ‹è¯•ä¹‹é—´æœ‰ä¾èµ–
```

### 4. æ¸…ç†æµ‹è¯•èµ„æº
```typescript
// æµ‹è¯•ç»“æŸåæ¸…ç†
db.close();
console.log("ğŸ§¹ Cleaned up test resources");
```

### 5. æ¸…æ™°çš„é”™è¯¯ä¿¡æ¯
```typescript
if (!result.success) {
  console.error("âŒ Test failed:", result.error);
  process.exit(1);
}
```

---

## CI/CD é›†æˆï¼ˆæœªæ¥ï¼‰

æœªæ¥å¯ä»¥åœ¨ GitHub Actions ä¸­è¿è¡Œæµ‹è¯•ï¼š

```yaml
# .github/workflows/test.yml
name: Tests
on: [push, pull_request]
jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: oven-sh/setup-bun@v1
      - run: bun install
      - run: bun run test/tools.test.ts
      - run: bun run test/agent.test.ts
```

---

## æµ‹è¯•è¦†ç›–ç‡ç›®æ ‡

- âœ… æ ¸å¿ƒå·¥å…·ç³»ç»Ÿï¼š100%
- âœ… Agent æ‰§è¡Œå™¨ï¼šåŸºæœ¬æµç¨‹è¦†ç›–
- ğŸš§ ç½‘ç»œè¯·æ±‚ï¼šé›†æˆæµ‹è¯•è¦†ç›–
- ğŸš§ LLM è°ƒç”¨ï¼šmock æµ‹è¯•ï¼ˆé˜¶æ®µ 2ï¼‰

---

## å¸¸è§é—®é¢˜

**Q: æµ‹è¯•å¤±è´¥æ€ä¹ˆåŠï¼Ÿ**
- æŸ¥çœ‹é”™è¯¯ä¿¡æ¯
- ç¡®è®¤æµ‹è¯•ç¯å¢ƒï¼ˆæ•°æ®åº“ã€é…ç½®ï¼‰
- æ£€æŸ¥ä¾èµ–æ˜¯å¦å®‰è£…

**Q: å¦‚ä½•è·³è¿‡æŸäº›æµ‹è¯•ï¼Ÿ**
- å•ç‹¬è¿è¡Œç‰¹å®šæµ‹è¯•æ–‡ä»¶
- æ³¨é‡Šæ‰ä¸éœ€è¦çš„æµ‹è¯•

**Q: æµ‹è¯•å¤ªæ…¢ï¼Ÿ**
- å•å…ƒæµ‹è¯•åº”è¯¥å¾ˆå¿«ï¼ˆ< 1ç§’ï¼‰
- å¦‚æœæ…¢ï¼Œå¯èƒ½æ˜¯åœ¨åšç½‘ç»œè¯·æ±‚
- å°†ç½‘ç»œè¯·æ±‚ç§»åˆ°é›†æˆæµ‹è¯•

---

## è´¡çŒ®æµ‹è¯•

æ¬¢è¿æ·»åŠ æ–°çš„æµ‹è¯•ï¼è¯·ç¡®ä¿ï¼š
1. æµ‹è¯•æœ‰æ¸…æ™°çš„æè¿°
2. æµ‹è¯•æ˜¯ç‹¬ç«‹çš„
3. æµ‹è¯•å®Œæˆåæ¸…ç†èµ„æº
4. æ›´æ–°è¿™ä¸ª README

---

## ä¸‹ä¸€æ­¥

- [ ] æ·»åŠ é›†æˆæµ‹è¯•
- [ ] æ·»åŠ æ€§èƒ½æµ‹è¯•
- [ ] é…ç½® CI/CD
- [ ] æµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š
